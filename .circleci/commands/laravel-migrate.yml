description: "Run Laravel Migrations"
steps:
  - run:
      name: Laravel Migrate
      command: |
        echo "ğŸ—„ï¸ Running Laravel database migrations ..."

        # Cek apakah container ada
        if ! docker ps --format '{{.Names}}' | grep -q '^yotta-dashboard$'; then
          echo "âŒ Container yotta-dashboard not running."
          exit 1
        fi

        # Jalankan migration
        if docker exec yotta-dashboard php artisan migrate --force; then
          echo "âœ… Laravel migrations completed successfully."
        else
          echo "âŒ Laravel migrations failed."
          docker exec yotta-dashboard php artisan migrate:status || echo "âš ï¸ Could not get migration status."
          exit 1
        fi

        # Tampilkan status migration
        echo "ğŸ“‹ Current migration status:"
        docker exec yotta-dashboard php artisan migrate:status || echo "âš ï¸ Failed to fetch migration status."